{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport Vue from 'vue';\nimport Vuex from 'vuex';\nimport { getAdmissionList, submitHealthAssessment, submitCareAssessment, getHealthAssessmentDetail, getCareAssessmentDetail, uploadMedicalReport } from '../api/admission';\nVue.use(Vuex);\nexport default new Vuex.Store({\n  state: {\n    patients: []\n  },\n  getters: {\n    pendingAdmissionCount: ({\n      patients\n    }) => {\n      return patients.filter(p => p.healthStatus === '待评估' || p.careStatus === '待评估').length;\n    },\n    pendingDischargeCount: () => {\n      return 0; // 暂时返回0，后续实现离院功能时再修改\n    }\n  },\n  mutations: {\n    SET_PATIENTS(state, patients) {\n      state.patients = patients;\n    },\n    updatePatientHealthAssessment(state, {\n      patient_id,\n      status,\n      time,\n      operator\n    }) {\n      const patient = state.patients.find(p => p.patient_id === patient_id);\n      if (patient) {\n        patient.healthStatus = status;\n        patient.healthTime = time;\n        patient.healthOperator = operator;\n      }\n    },\n    updatePatientCareAssessment(state, {\n      patient_id,\n      status,\n      time,\n      operator\n    }) {\n      const patient = state.patients.find(p => p.patient_id === patient_id);\n      if (patient) {\n        patient.careStatus = status;\n        patient.careTime = time;\n        patient.careOperator = operator;\n      }\n    },\n    completeAdmission(state, patient_id) {\n      const patient = state.patients.find(p => p.id === patient_id);\n      if (patient) {\n        patient.admissionCompleted = true;\n      }\n    }\n  },\n  actions: {\n    async fetchPatients({\n      commit\n    }, params) {\n      try {\n        const response = await getAdmissionList(params);\n        commit('SET_PATIENTS', response.data.records);\n        return response;\n      } catch (error) {\n        console.error('获取患者列表失败:', error);\n        throw error;\n      }\n    },\n    async updateHealthAssessment({\n      commit\n    }, payload) {\n      try {\n        await submitHealthAssessment(payload);\n        commit('updatePatientHealthAssessment', {\n          patient_id: payload.patient_id,\n          status: payload.status === 'completed' ? '完成' : payload.status === 'rejected' ? '不同意入院' : '待评估',\n          time: payload.time,\n          operator: payload.operator\n        });\n      } catch (error) {\n        console.error('更新健康评估失败:', error);\n        throw error;\n      }\n    },\n    async updateCareAssessment({\n      commit\n    }, payload) {\n      try {\n        await submitCareAssessment(payload);\n        commit('updatePatientCareAssessment', {\n          patient_id: payload.patient_id,\n          status: payload.status === 'completed' ? '完成' : payload.status === 'rejected' ? '不同意入院' : '待评估',\n          time: payload.time,\n          operator: payload.operator\n        });\n      } catch (error) {\n        console.error('更新照护评估失败:', error);\n        throw error;\n      }\n    },\n    async fetchHealthAssessmentDetail(commit, id) {\n      const response = await getHealthAssessmentDetail(id);\n      return response;\n    },\n    async fetchCareAssessmentDetail(commit, id) {\n      const response = await getCareAssessmentDetail(id);\n      return response;\n    },\n    async uploadMedicalReport(commit, payload) {\n      const response = await uploadMedicalReport(payload);\n      return response;\n    },\n    async finishAdmission({\n      commit\n    }, patient_id) {\n      try {\n        // 这里可以添加完成入院的 API 调用\n        commit('completeAdmission', patient_id);\n      } catch (error) {\n        console.error('完成入院失败:', error);\n        throw error;\n      }\n    }\n  },\n  modules: {}\n});","map":{"version":3,"names":["Vue","Vuex","getAdmissionList","submitHealthAssessment","submitCareAssessment","getHealthAssessmentDetail","getCareAssessmentDetail","uploadMedicalReport","use","Store","state","patients","getters","pendingAdmissionCount","filter","p","healthStatus","careStatus","length","pendingDischargeCount","mutations","SET_PATIENTS","updatePatientHealthAssessment","patient_id","status","time","operator","patient","find","healthTime","healthOperator","updatePatientCareAssessment","careTime","careOperator","completeAdmission","id","admissionCompleted","actions","fetchPatients","commit","params","response","data","records","error","console","updateHealthAssessment","payload","updateCareAssessment","fetchHealthAssessmentDetail","fetchCareAssessmentDetail","finishAdmission","modules"],"sources":["/Users/seaocean/projects/test3/hospital/src/store/index.js"],"sourcesContent":["import Vue from 'vue'\nimport Vuex from 'vuex'\nimport {\n  getAdmissionList,\n  submitHealthAssessment,\n  submitCareAssessment,\n  getHealthAssessmentDetail,\n  getCareAssessmentDetail,\n  uploadMedicalReport\n} from '../api/admission'\n\nVue.use(Vuex)\n\nexport default new Vuex.Store({\n  state: {\n    patients: []\n  },\n  getters: {\n    pendingAdmissionCount: ({ patients }) => {\n      return patients.filter(p =>\n        p.healthStatus === '待评估' || p.careStatus === '待评估'\n      ).length\n    },\n    pendingDischargeCount: () => {\n      return 0 // 暂时返回0，后续实现离院功能时再修改\n    }\n  },\n  mutations: {\n    SET_PATIENTS(state, patients) {\n      state.patients = patients\n    },\n    updatePatientHealthAssessment(state, { patient_id, status, time, operator }) {\n      const patient = state.patients.find(p => p.patient_id === patient_id);\n      if (patient) {\n        patient.healthStatus = status;\n        patient.healthTime = time;\n        patient.healthOperator = operator;\n      }\n    },\n    updatePatientCareAssessment(state, { patient_id, status, time, operator }) {\n      const patient = state.patients.find(p => p.patient_id === patient_id);\n      if (patient) {\n        patient.careStatus = status;\n        patient.careTime = time;\n        patient.careOperator = operator;\n      }\n    },\n    completeAdmission(state, patient_id) {\n      const patient = state.patients.find(p => p.id === patient_id);\n      if (patient) {\n        patient.admissionCompleted = true;\n      }\n    }\n  },\n  actions: {\n    async fetchPatients({ commit }, params) {\n      try {\n        const response = await getAdmissionList(params)\n        commit('SET_PATIENTS', response.data.records)\n        return response\n      } catch (error) {\n        console.error('获取患者列表失败:', error)\n        throw error\n      }\n    },\n    async updateHealthAssessment({ commit }, payload) {\n      try {\n        await submitHealthAssessment(payload);\n        commit('updatePatientHealthAssessment', {\n          patient_id: payload.patient_id,\n          status: payload.status === 'completed' ? '完成' :\n            payload.status === 'rejected' ? '不同意入院' : '待评估',\n          time: payload.time,\n          operator: payload.operator\n        });\n      } catch (error) {\n        console.error('更新健康评估失败:', error);\n        throw error;\n      }\n    },\n    async updateCareAssessment({ commit }, payload) {\n      try {\n        await submitCareAssessment(payload);\n        commit('updatePatientCareAssessment', {\n          patient_id: payload.patient_id,\n          status: payload.status === 'completed' ? '完成' :\n            payload.status === 'rejected' ? '不同意入院' : '待评估',\n          time: payload.time,\n          operator: payload.operator\n        });\n      } catch (error) {\n        console.error('更新照护评估失败:', error);\n        throw error;\n      }\n    },\n    async fetchHealthAssessmentDetail(commit, id) {\n      const response = await getHealthAssessmentDetail(id);\n      return response;\n    },\n    async fetchCareAssessmentDetail(commit, id) {\n      const response = await getCareAssessmentDetail(id);\n      return response;\n    },\n    async uploadMedicalReport(commit, payload) {\n      const response = await uploadMedicalReport(payload);\n      return response;\n    },\n    async finishAdmission({ commit }, patient_id) {\n      try {\n        // 这里可以添加完成入院的 API 调用\n        commit('completeAdmission', patient_id);\n      } catch (error) {\n        console.error('完成入院失败:', error);\n        throw error;\n      }\n    }\n  },\n  modules: {\n  }\n}) "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}