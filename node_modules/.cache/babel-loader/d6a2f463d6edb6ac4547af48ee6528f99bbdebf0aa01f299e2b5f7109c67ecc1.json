{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { getAdmissionList } from '@/api/admission';\nexport default {\n  name: 'PatientAssessment',\n  data() {\n    return {\n      activeTab: 'assessment',\n      dateRange: [],\n      searchText: '',\n      currentPage: 1,\n      pageSize: 10,\n      loading: false,\n      patientList: [],\n      total: 0\n    };\n  },\n  methods: {\n    async fetchPatientList() {\n      try {\n        this.loading = true;\n        const params = {\n          page: this.currentPage,\n          size: this.pageSize,\n          keyword: this.searchText,\n          startDate: this.dateRange?.[0],\n          endDate: this.dateRange?.[1]\n        };\n        const response = await getAdmissionList(params);\n        if (response.code === 200 && response.data) {\n          this.patientList = response.data.records || [];\n          this.total = response.data.total || 0;\n        } else {\n          this.$message.error(response.message || '获取数据失败');\n        }\n      } catch (error) {\n        console.error('获取患者列表失败:', error);\n        this.$message.error('获取患者列表失败，请稍后重试');\n      } finally {\n        this.loading = false;\n      }\n    },\n    handleSearch() {\n      this.currentPage = 1;\n      this.fetchPatientList();\n    },\n    handleDateChange() {\n      this.currentPage = 1;\n      this.fetchPatientList();\n    },\n    handleSizeChange(val) {\n      this.pageSize = val;\n      this.currentPage = 1;\n      this.fetchPatientList();\n    },\n    handleCurrentChange(val) {\n      this.currentPage = val;\n      this.fetchPatientList();\n    },\n    formatDateTime(date) {\n      if (!date) return '';\n      const d = new Date(date);\n      return `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, '0')}-${String(d.getDate()).padStart(2, '0')} ${String(d.getHours()).padStart(2, '0')}:${String(d.getMinutes()).padStart(2, '0')}`;\n    },\n    getStatusType(status) {\n      switch (status) {\n        case '待评估':\n          return 'warning';\n        case '未完成':\n          return 'danger';\n        case '已完成':\n          return 'success';\n        default:\n          return 'info';\n      }\n    },\n    canEdit(row) {\n      return row.healthAssessmentStatus === '待评估' || row.healthAssessmentStatus === '未完成';\n    },\n    editAssessment(row) {\n      const assessmentId = row.patientId;\n      if (!assessmentId) {\n        this.$message.error('无效的评估ID');\n        return;\n      }\n      this.$router.push(`/health-assessment/${assessmentId}`);\n    },\n    viewDetails(row) {\n      this.$router.push({\n        path: '/admission-details',\n        query: {\n          id: row.patientId\n        }\n      });\n    }\n  },\n  created() {\n    this.fetchPatientList();\n  }\n};","map":{"version":3,"names":["getAdmissionList","name","data","activeTab","dateRange","searchText","currentPage","pageSize","loading","patientList","total","methods","fetchPatientList","params","page","size","keyword","startDate","endDate","response","code","records","$message","error","message","console","handleSearch","handleDateChange","handleSizeChange","val","handleCurrentChange","formatDateTime","date","d","Date","getFullYear","String","getMonth","padStart","getDate","getHours","getMinutes","getStatusType","status","canEdit","row","healthAssessmentStatus","editAssessment","assessmentId","patientId","$router","push","viewDetails","path","query","id","created"],"sources":["src/views/PatientAssessment.vue"],"sourcesContent":["<template>\n  <div class=\"assessment-container\">\n    <!-- 标签页导航 -->\n    <el-tabs v-model=\"activeTab\" type=\"card\" class=\"custom-tabs\">\n      <el-tab-pane name=\"assessment\">\n        <span slot=\"label\">\n          入院评估\n          <el-badge :value=\"3\" class=\"tab-badge\" type=\"primary\"></el-badge>\n        </span>\n        <!-- 入院评估内容 -->\n        <div class=\"search-section\">\n          <div class=\"search-form\">\n            <div class=\"form-item\">\n              <span class=\"label\">登记日期</span>\n              <el-date-picker\n                v-model=\"dateRange\"\n                type=\"daterange\"\n                range-separator=\"~\"\n                start-placeholder=\"开始日期\"\n                end-placeholder=\"结束日期\"\n                format=\"yyyy/MM/dd\"\n                value-format=\"yyyy-MM-dd\"\n                :default-time=\"['00:00:00', '23:59:59']\"\n                @change=\"handleDateChange\">\n              </el-date-picker>\n            </div>\n            <div class=\"form-item\">\n              <el-input\n                v-model=\"searchText\"\n                placeholder=\"姓名/入院编号\"\n                class=\"search-input\"\n                @input=\"handleSearch\">\n                <el-button slot=\"append\" icon=\"el-icon-search\" @click=\"handleSearch\"></el-button>\n              </el-input>\n            </div>\n          </div>\n        </div>\n        <!-- 评估列表内容 -->\n        <div class=\"list-section\">\n          <el-table\n            :data=\"patientList\"\n            v-loading=\"loading\"\n            style=\"width: 100%\">\n            <el-table-column\n              prop=\"patientName\"\n              label=\"姓名\"\n              width=\"120\">\n            </el-table-column>\n            <el-table-column\n              prop=\"patientGender\"\n              label=\"性别\"\n              width=\"80\">\n            </el-table-column>\n            <el-table-column\n              prop=\"patientAge\"\n              label=\"年龄\"\n              width=\"80\">\n            </el-table-column>\n            <el-table-column\n              prop=\"registrationTime\"\n              label=\"登记时间\"\n              width=\"180\">\n              <template slot-scope=\"scope\">\n                {{ formatDateTime(scope.row.registrationTime) }}\n              </template>\n            </el-table-column>\n            <el-table-column\n              prop=\"healthAssessmentStatus\"\n              label=\"健康评估\"\n              width=\"120\">\n              <template slot-scope=\"scope\">\n                <el-tag\n                  :type=\"getStatusType(scope.row.healthAssessmentStatus)\"\n                  size=\"small\">\n                  {{ scope.row.healthAssessmentStatus }}\n                </el-tag>\n              </template>\n            </el-table-column>\n            <el-table-column\n              prop=\"careAssessmentStatus\"\n              label=\"首次照护评估\"\n              width=\"120\">\n              <template slot-scope=\"scope\">\n                <el-tag\n                  :type=\"getStatusType(scope.row.careAssessmentStatus)\"\n                  size=\"small\">\n                  {{ scope.row.careAssessmentStatus }}\n                </el-tag>\n              </template>\n            </el-table-column>\n            <el-table-column\n              label=\"操作\"\n              width=\"100\"\n              fixed=\"right\">\n              <template slot-scope=\"scope\">\n                <el-button\n                  v-if=\"canEdit(scope.row)\"\n                  type=\"text\"\n                  size=\"small\"\n                  @click=\"editAssessment(scope.row)\">\n                  <i class=\"el-icon-edit\"></i>\n                  编辑\n                </el-button>\n                <el-button\n                  v-else\n                  type=\"text\"\n                  size=\"small\"\n                  @click=\"viewDetails(scope.row)\">\n                  <i class=\"el-icon-view\"></i>\n                  查看\n                </el-button>\n              </template>\n            </el-table-column>\n          </el-table>\n\n          <!-- 分页 -->\n          <div class=\"pagination-section\">\n            <el-pagination\n              @size-change=\"handleSizeChange\"\n              @current-change=\"handleCurrentChange\"\n              :current-page=\"currentPage\"\n              :page-sizes=\"[10, 20, 50]\"\n              :page-size=\"pageSize\"\n              layout=\"total, sizes, prev, pager, next, jumper\"\n              :total=\"total\">\n            </el-pagination>\n          </div>\n        </div>\n      </el-tab-pane>\n      \n      <el-tab-pane name=\"discharge\">\n        <span slot=\"label\">\n          离院办理\n          <el-badge :value=\"0\" class=\"tab-badge\" type=\"info\"></el-badge>\n        </span>\n        <!-- 离院办理内容 -->\n      </el-tab-pane>\n    </el-tabs>\n  </div>\n</template>\n\n<script>\nimport { getAdmissionList } from '@/api/admission'\n\nexport default {\n  name: 'PatientAssessment',\n  data() {\n    return {\n      activeTab: 'assessment',\n      dateRange: [],\n      searchText: '',\n      currentPage: 1,\n      pageSize: 10,\n      loading: false,\n      patientList: [],\n      total: 0\n    }\n  },\n  methods: {\n    async fetchPatientList() {\n      try {\n        this.loading = true\n        const params = {\n          page: this.currentPage,\n          size: this.pageSize,\n          keyword: this.searchText,\n          startDate: this.dateRange?.[0],\n          endDate: this.dateRange?.[1]\n        }\n        const response = await getAdmissionList(params)\n        \n        if (response.code === 200 && response.data) {\n          this.patientList = response.data.records || []\n          this.total = response.data.total || 0\n        } else {\n          this.$message.error(response.message || '获取数据失败')\n        }\n      } catch (error) {\n        console.error('获取患者列表失败:', error)\n        this.$message.error('获取患者列表失败，请稍后重试')\n      } finally {\n        this.loading = false\n      }\n    },\n    handleSearch() {\n      this.currentPage = 1\n      this.fetchPatientList()\n    },\n    handleDateChange() {\n      this.currentPage = 1\n      this.fetchPatientList()\n    },\n    handleSizeChange(val) {\n      this.pageSize = val\n      this.currentPage = 1\n      this.fetchPatientList()\n    },\n    handleCurrentChange(val) {\n      this.currentPage = val\n      this.fetchPatientList()\n    },\n    formatDateTime(date) {\n      if (!date) return ''\n      const d = new Date(date)\n      return `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, '0')}-${String(d.getDate()).padStart(2, '0')} ${String(d.getHours()).padStart(2, '0')}:${String(d.getMinutes()).padStart(2, '0')}`\n    },\n    getStatusType(status) {\n      switch (status) {\n        case '待评估':\n          return 'warning'\n        case '未完成':\n          return 'danger'\n        case '已完成':\n          return 'success'\n        default:\n          return 'info'\n      }\n    },\n    canEdit(row) {\n      return row.healthAssessmentStatus === '待评估' || row.healthAssessmentStatus === '未完成'\n    },\n    editAssessment(row) {\n      const assessmentId = row.patientId\n      if (!assessmentId) {\n        this.$message.error('无效的评估ID')\n        return\n      }\n      this.$router.push(`/health-assessment/${assessmentId}`)\n    },\n    viewDetails(row) {\n      this.$router.push({\n        path: '/admission-details',\n        query: { id: row.patientId }\n      })\n    }\n  },\n  created() {\n    this.fetchPatientList()\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.assessment-container {\n  padding: 20px;\n  background-color: #fff;\n  border-radius: 4px;\n  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);\n}\n\n.search-section {\n  margin-bottom: 20px;\n  padding: 16px;\n  background-color: #f5f7fa;\n  border-radius: 4px;\n}\n\n.search-form {\n  display: flex;\n  align-items: center;\n  gap: 16px;\n}\n\n.form-item {\n  display: flex;\n  align-items: center;\n\n  .label {\n    margin-right: 8px;\n    color: #606266;\n  }\n}\n\n.search-input {\n  width: 200px;\n}\n\n.list-section {\n  margin-top: 16px;\n}\n\n.pagination-section {\n  margin-top: 16px;\n  display: flex;\n  justify-content: flex-end;\n}\n\n:deep(.el-table) {\n  margin-top: 16px;\n}\n\n:deep(.el-pagination) {\n  padding: 0;\n}\n</style> "],"mappings":";AA8IA,SAAAA,gBAAA;AAEA;EACAC,IAAA;EACAC,KAAA;IACA;MACAC,SAAA;MACAC,SAAA;MACAC,UAAA;MACAC,WAAA;MACAC,QAAA;MACAC,OAAA;MACAC,WAAA;MACAC,KAAA;IACA;EACA;EACAC,OAAA;IACA,MAAAC,iBAAA;MACA;QACA,KAAAJ,OAAA;QACA,MAAAK,MAAA;UACAC,IAAA,OAAAR,WAAA;UACAS,IAAA,OAAAR,QAAA;UACAS,OAAA,OAAAX,UAAA;UACAY,SAAA,OAAAb,SAAA;UACAc,OAAA,OAAAd,SAAA;QACA;QACA,MAAAe,QAAA,SAAAnB,gBAAA,CAAAa,MAAA;QAEA,IAAAM,QAAA,CAAAC,IAAA,YAAAD,QAAA,CAAAjB,IAAA;UACA,KAAAO,WAAA,GAAAU,QAAA,CAAAjB,IAAA,CAAAmB,OAAA;UACA,KAAAX,KAAA,GAAAS,QAAA,CAAAjB,IAAA,CAAAQ,KAAA;QACA;UACA,KAAAY,QAAA,CAAAC,KAAA,CAAAJ,QAAA,CAAAK,OAAA;QACA;MACA,SAAAD,KAAA;QACAE,OAAA,CAAAF,KAAA,cAAAA,KAAA;QACA,KAAAD,QAAA,CAAAC,KAAA;MACA;QACA,KAAAf,OAAA;MACA;IACA;IACAkB,aAAA;MACA,KAAApB,WAAA;MACA,KAAAM,gBAAA;IACA;IACAe,iBAAA;MACA,KAAArB,WAAA;MACA,KAAAM,gBAAA;IACA;IACAgB,iBAAAC,GAAA;MACA,KAAAtB,QAAA,GAAAsB,GAAA;MACA,KAAAvB,WAAA;MACA,KAAAM,gBAAA;IACA;IACAkB,oBAAAD,GAAA;MACA,KAAAvB,WAAA,GAAAuB,GAAA;MACA,KAAAjB,gBAAA;IACA;IACAmB,eAAAC,IAAA;MACA,KAAAA,IAAA;MACA,MAAAC,CAAA,OAAAC,IAAA,CAAAF,IAAA;MACA,UAAAC,CAAA,CAAAE,WAAA,MAAAC,MAAA,CAAAH,CAAA,CAAAI,QAAA,QAAAC,QAAA,YAAAF,MAAA,CAAAH,CAAA,CAAAM,OAAA,IAAAD,QAAA,YAAAF,MAAA,CAAAH,CAAA,CAAAO,QAAA,IAAAF,QAAA,YAAAF,MAAA,CAAAH,CAAA,CAAAQ,UAAA,IAAAH,QAAA;IACA;IACAI,cAAAC,MAAA;MACA,QAAAA,MAAA;QACA;UACA;QACA;UACA;QACA;UACA;QACA;UACA;MACA;IACA;IACAC,QAAAC,GAAA;MACA,OAAAA,GAAA,CAAAC,sBAAA,cAAAD,GAAA,CAAAC,sBAAA;IACA;IACAC,eAAAF,GAAA;MACA,MAAAG,YAAA,GAAAH,GAAA,CAAAI,SAAA;MACA,KAAAD,YAAA;QACA,KAAA1B,QAAA,CAAAC,KAAA;QACA;MACA;MACA,KAAA2B,OAAA,CAAAC,IAAA,uBAAAH,YAAA;IACA;IACAI,YAAAP,GAAA;MACA,KAAAK,OAAA,CAAAC,IAAA;QACAE,IAAA;QACAC,KAAA;UAAAC,EAAA,EAAAV,GAAA,CAAAI;QAAA;MACA;IACA;EACA;EACAO,QAAA;IACA,KAAA5C,gBAAA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}