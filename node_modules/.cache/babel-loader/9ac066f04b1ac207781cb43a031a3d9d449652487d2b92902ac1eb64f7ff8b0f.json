{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nexport default {\n  name: 'HealthAssessment',\n  data() {\n    return {\n      patientId: this.$route.params.id,\n      viewMode: false,\n      patientInfo: {\n        name: '',\n        gender: '',\n        age: '',\n        admission_number: '',\n        bed_number: '',\n        care_grade: '',\n        registration_date: ''\n      },\n      assessmentForm: {\n        current_illness: [],\n        forbidden_medicines: '',\n        diet_restrictions: [],\n        physical_conclusion: '',\n        admission_agreement: '同意入院'\n      },\n      illnessList: [{\n        value: '头疼痛',\n        label: '头疼痛'\n      }, {\n        value: '发热',\n        label: '发热'\n      }, {\n        value: '咳嗽',\n        label: '咳嗽'\n      }],\n      dietList: [{\n        value: '忌辣',\n        label: '忌辣'\n      }, {\n        value: '忌海鲜',\n        label: '忌海鲜'\n      }, {\n        value: '忌油腻',\n        label: '忌油腻'\n      }],\n      rules: {\n        physical_conclusion: [{\n          required: true,\n          message: '请输入体检结论',\n          trigger: 'blur'\n        }],\n        admission_agreement: [{\n          required: true,\n          message: '请选择入院意见',\n          trigger: 'change'\n        }]\n      }\n    };\n  },\n  created() {\n    this.fetchPatientInfo();\n    this.fetchAssessmentInfo();\n  },\n  methods: {\n    async fetchPatientInfo() {\n      try {\n        // TODO: 调用获取患者信息接口\n        const response = await this.$http.get(`/api/patient/info/${this.patientId}`);\n        this.patientInfo = response.data.data;\n      } catch (error) {\n        this.$message.error('获取患者信息失败');\n      }\n    },\n    async fetchAssessmentInfo() {\n      try {\n        const response = await this.$http.get(`/api/health-assessment/detail?assessment_id=${this.patientId}`);\n        if (response.data.code === 200) {\n          const data = response.data.data;\n          this.assessmentForm = {\n            current_illness: data.current_illness || [],\n            forbidden_medicines: data.forbidden_medicines || '',\n            diet_restrictions: data.diet_restrictions || [],\n            physical_conclusion: data.physical_conclusion || '',\n            admission_agreement: data.admission_agreement || '同意入院'\n          };\n          // 如果已经完成评估，设置为查看模式\n          this.viewMode = data.status === 'completed';\n        }\n      } catch (error) {\n        this.$message.error('获取评估信息失败');\n      }\n    },\n    async submitForm() {\n      try {\n        await this.$refs.assessmentForm.validate();\n        const response = await this.$http.post('/api/health-assessment/submit', {\n          assessment_id: this.patientId,\n          ...this.assessmentForm\n        });\n        if (response.data.code === 200) {\n          this.$message.success('保存成功');\n          this.$router.push('/assessment');\n        }\n      } catch (error) {\n        if (error.message) {\n          this.$message.error(error.message);\n        }\n      }\n    }\n  }\n};","map":{"version":3,"names":["name","data","patientId","$route","params","id","viewMode","patientInfo","gender","age","admission_number","bed_number","care_grade","registration_date","assessmentForm","current_illness","forbidden_medicines","diet_restrictions","physical_conclusion","admission_agreement","illnessList","value","label","dietList","rules","required","message","trigger","created","fetchPatientInfo","fetchAssessmentInfo","methods","response","$http","get","error","$message","code","status","submitForm","$refs","validate","post","assessment_id","success","$router","push"],"sources":["src/views/HealthAssessment.vue"],"sourcesContent":["<template>\n  <div class=\"health-assessment\">\n    <!-- 患者基本信息卡片 -->\n    <el-card class=\"info-card\">\n      <div slot=\"header\">\n        <span class=\"card-title\">患者信息</span>\n      </div>\n      <el-row :gutter=\"20\">\n        <el-col :span=\"6\">\n          <div class=\"info-item\">\n            <span class=\"label\">姓名：</span>\n            <span class=\"value\">{{ patientInfo.name }}</span>\n          </div>\n        </el-col>\n        <el-col :span=\"6\">\n          <div class=\"info-item\">\n            <span class=\"label\">性别：</span>\n            <span class=\"value\">{{ patientInfo.gender }}</span>\n          </div>\n        </el-col>\n        <el-col :span=\"6\">\n          <div class=\"info-item\">\n            <span class=\"label\">年龄：</span>\n            <span class=\"value\">{{ patientInfo.age }}岁</span>\n          </div>\n        </el-col>\n        <el-col :span=\"6\">\n          <div class=\"info-item\">\n            <span class=\"label\">入院编号：</span>\n            <span class=\"value\">{{ patientInfo.admission_number }}</span>\n          </div>\n        </el-col>\n      </el-row>\n      <el-row :gutter=\"20\" style=\"margin-top: 20px;\">\n        <el-col :span=\"6\">\n          <div class=\"info-item\">\n            <span class=\"label\">床位号：</span>\n            <span class=\"value\">{{ patientInfo.bed_number }}</span>\n          </div>\n        </el-col>\n        <el-col :span=\"6\">\n          <div class=\"info-item\">\n            <span class=\"label\">护理等级：</span>\n            <span class=\"value\">{{ patientInfo.care_grade }}</span>\n          </div>\n        </el-col>\n        <el-col :span=\"12\">\n          <div class=\"info-item\">\n            <span class=\"label\">登记时间：</span>\n            <span class=\"value\">{{ patientInfo.registration_date }}</span>\n          </div>\n        </el-col>\n      </el-row>\n    </el-card>\n\n    <!-- 健康评估表单 -->\n    <el-card class=\"assessment-card\">\n      <div slot=\"header\">\n        <span class=\"card-title\">健康评估</span>\n      </div>\n      \n      <el-form \n        ref=\"assessmentForm\" \n        :model=\"assessmentForm\" \n        :rules=\"rules\"\n        label-width=\"100px\"\n        :disabled=\"viewMode\">\n        \n        <el-form-item label=\"现病史\" prop=\"current_illness\">\n          <el-select\n            v-model=\"assessmentForm.current_illness\"\n            multiple\n            filterable\n            allow-create\n            default-first-option\n            placeholder=\"请选择或输入现病史\">\n            <el-option\n              v-for=\"item in illnessList\"\n              :key=\"item.value\"\n              :label=\"item.label\"\n              :value=\"item.value\">\n            </el-option>\n          </el-select>\n        </el-form-item>\n\n        <el-form-item label=\"禁忌药品\" prop=\"forbidden_medicines\">\n          <el-input\n            type=\"textarea\"\n            v-model=\"assessmentForm.forbidden_medicines\"\n            :rows=\"2\"\n            placeholder=\"请输入禁忌药品\">\n          </el-input>\n        </el-form-item>\n\n        <el-form-item label=\"饮食禁忌\" prop=\"diet_restrictions\">\n          <el-select\n            v-model=\"assessmentForm.diet_restrictions\"\n            multiple\n            placeholder=\"请选择饮食禁忌\">\n            <el-option\n              v-for=\"item in dietList\"\n              :key=\"item.value\"\n              :label=\"item.label\"\n              :value=\"item.value\">\n            </el-option>\n          </el-select>\n        </el-form-item>\n\n        <el-form-item label=\"体检结论\" prop=\"physical_conclusion\">\n          <el-input\n            type=\"textarea\"\n            v-model=\"assessmentForm.physical_conclusion\"\n            :rows=\"3\"\n            placeholder=\"请输入体检结论\">\n          </el-input>\n        </el-form-item>\n\n        <el-form-item label=\"入院意见\" prop=\"admission_agreement\">\n          <el-radio-group v-model=\"assessmentForm.admission_agreement\">\n            <el-radio label=\"同意入院\">同意入院</el-radio>\n            <el-radio label=\"不同意入院\">不同意入院</el-radio>\n          </el-radio-group>\n        </el-form-item>\n\n        <el-form-item>\n          <el-button \n            type=\"primary\" \n            @click=\"submitForm\"\n            v-if=\"!viewMode\">\n            保存评估\n          </el-button>\n        </el-form-item>\n      </el-form>\n    </el-card>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'HealthAssessment',\n  data() {\n    return {\n      patientId: this.$route.params.id,\n      viewMode: false,\n      patientInfo: {\n        name: '',\n        gender: '',\n        age: '',\n        admission_number: '',\n        bed_number: '',\n        care_grade: '',\n        registration_date: ''\n      },\n      assessmentForm: {\n        current_illness: [],\n        forbidden_medicines: '',\n        diet_restrictions: [],\n        physical_conclusion: '',\n        admission_agreement: '同意入院'\n      },\n      illnessList: [\n        { value: '头疼痛', label: '头疼痛' },\n        { value: '发热', label: '发热' },\n        { value: '咳嗽', label: '咳嗽' }\n      ],\n      dietList: [\n        { value: '忌辣', label: '忌辣' },\n        { value: '忌海鲜', label: '忌海鲜' },\n        { value: '忌油腻', label: '忌油腻' }\n      ],\n      rules: {\n        physical_conclusion: [\n          { required: true, message: '请输入体检结论', trigger: 'blur' }\n        ],\n        admission_agreement: [\n          { required: true, message: '请选择入院意见', trigger: 'change' }\n        ]\n      }\n    }\n  },\n  created() {\n    this.fetchPatientInfo()\n    this.fetchAssessmentInfo()\n  },\n  methods: {\n    async fetchPatientInfo() {\n      try {\n        // TODO: 调用获取患者信息接口\n        const response = await this.$http.get(`/api/patient/info/${this.patientId}`)\n        this.patientInfo = response.data.data\n      } catch (error) {\n        this.$message.error('获取患者信息失败')\n      }\n    },\n    async fetchAssessmentInfo() {\n      try {\n        const response = await this.$http.get(`/api/health-assessment/detail?assessment_id=${this.patientId}`)\n        if (response.data.code === 200) {\n          const data = response.data.data\n          this.assessmentForm = {\n            current_illness: data.current_illness || [],\n            forbidden_medicines: data.forbidden_medicines || '',\n            diet_restrictions: data.diet_restrictions || [],\n            physical_conclusion: data.physical_conclusion || '',\n            admission_agreement: data.admission_agreement || '同意入院'\n          }\n          // 如果已经完成评估，设置为查看模式\n          this.viewMode = data.status === 'completed'\n        }\n      } catch (error) {\n        this.$message.error('获取评估信息失败')\n      }\n    },\n    async submitForm() {\n      try {\n        await this.$refs.assessmentForm.validate()\n        const response = await this.$http.post('/api/health-assessment/submit', {\n          assessment_id: this.patientId,\n          ...this.assessmentForm\n        })\n        if (response.data.code === 200) {\n          this.$message.success('保存成功')\n          this.$router.push('/assessment')\n        }\n      } catch (error) {\n        if (error.message) {\n          this.$message.error(error.message)\n        }\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.health-assessment {\n  padding: 20px;\n\n  .info-card, .assessment-card {\n    margin-bottom: 20px;\n  }\n\n  .card-title {\n    font-size: 16px;\n    font-weight: 500;\n  }\n\n  .info-item {\n    display: flex;\n    align-items: center;\n    line-height: 32px;\n\n    .label {\n      color: #606266;\n      margin-right: 10px;\n    }\n\n    .value {\n      color: #303133;\n    }\n  }\n\n  .el-form {\n    max-width: 800px;\n    margin: 0 auto;\n  }\n}\n</style> "],"mappings":";AA0IA;EACAA,IAAA;EACAC,KAAA;IACA;MACAC,SAAA,OAAAC,MAAA,CAAAC,MAAA,CAAAC,EAAA;MACAC,QAAA;MACAC,WAAA;QACAP,IAAA;QACAQ,MAAA;QACAC,GAAA;QACAC,gBAAA;QACAC,UAAA;QACAC,UAAA;QACAC,iBAAA;MACA;MACAC,cAAA;QACAC,eAAA;QACAC,mBAAA;QACAC,iBAAA;QACAC,mBAAA;QACAC,mBAAA;MACA;MACAC,WAAA,GACA;QAAAC,KAAA;QAAAC,KAAA;MAAA,GACA;QAAAD,KAAA;QAAAC,KAAA;MAAA,GACA;QAAAD,KAAA;QAAAC,KAAA;MAAA,EACA;MACAC,QAAA,GACA;QAAAF,KAAA;QAAAC,KAAA;MAAA,GACA;QAAAD,KAAA;QAAAC,KAAA;MAAA,GACA;QAAAD,KAAA;QAAAC,KAAA;MAAA,EACA;MACAE,KAAA;QACAN,mBAAA,GACA;UAAAO,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA,EACA;QACAR,mBAAA,GACA;UAAAM,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA;MAEA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,gBAAA;IACA,KAAAC,mBAAA;EACA;EACAC,OAAA;IACA,MAAAF,iBAAA;MACA;QACA;QACA,MAAAG,QAAA,cAAAC,KAAA,CAAAC,GAAA,2BAAAhC,SAAA;QACA,KAAAK,WAAA,GAAAyB,QAAA,CAAA/B,IAAA,CAAAA,IAAA;MACA,SAAAkC,KAAA;QACA,KAAAC,QAAA,CAAAD,KAAA;MACA;IACA;IACA,MAAAL,oBAAA;MACA;QACA,MAAAE,QAAA,cAAAC,KAAA,CAAAC,GAAA,qDAAAhC,SAAA;QACA,IAAA8B,QAAA,CAAA/B,IAAA,CAAAoC,IAAA;UACA,MAAApC,IAAA,GAAA+B,QAAA,CAAA/B,IAAA,CAAAA,IAAA;UACA,KAAAa,cAAA;YACAC,eAAA,EAAAd,IAAA,CAAAc,eAAA;YACAC,mBAAA,EAAAf,IAAA,CAAAe,mBAAA;YACAC,iBAAA,EAAAhB,IAAA,CAAAgB,iBAAA;YACAC,mBAAA,EAAAjB,IAAA,CAAAiB,mBAAA;YACAC,mBAAA,EAAAlB,IAAA,CAAAkB,mBAAA;UACA;UACA;UACA,KAAAb,QAAA,GAAAL,IAAA,CAAAqC,MAAA;QACA;MACA,SAAAH,KAAA;QACA,KAAAC,QAAA,CAAAD,KAAA;MACA;IACA;IACA,MAAAI,WAAA;MACA;QACA,WAAAC,KAAA,CAAA1B,cAAA,CAAA2B,QAAA;QACA,MAAAT,QAAA,cAAAC,KAAA,CAAAS,IAAA;UACAC,aAAA,OAAAzC,SAAA;UACA,QAAAY;QACA;QACA,IAAAkB,QAAA,CAAA/B,IAAA,CAAAoC,IAAA;UACA,KAAAD,QAAA,CAAAQ,OAAA;UACA,KAAAC,OAAA,CAAAC,IAAA;QACA;MACA,SAAAX,KAAA;QACA,IAAAA,KAAA,CAAAT,OAAA;UACA,KAAAU,QAAA,CAAAD,KAAA,CAAAA,KAAA,CAAAT,OAAA;QACA;MACA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}