{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nexport default {\n  name: 'HealthAssessment',\n  props: {\n    id: {\n      type: String,\n      required: true\n    }\n  },\n  data() {\n    return {\n      viewMode: false,\n      patientInfo: {\n        name: '',\n        gender: '',\n        age: '',\n        admission_number: '',\n        bed_number: '',\n        care_grade: '',\n        registration_date: ''\n      },\n      assessmentForm: {\n        current_illness: [],\n        forbidden_medicines: '',\n        diet_restrictions: [],\n        physical_conclusion: '',\n        admission_agreement: '同意入院'\n      },\n      illnessList: [{\n        value: '头疼痛',\n        label: '头疼痛'\n      }, {\n        value: '发热',\n        label: '发热'\n      }, {\n        value: '咳嗽',\n        label: '咳嗽'\n      }],\n      dietRestrictionList: [{\n        value: '忌辣',\n        label: '忌辣'\n      }, {\n        value: '忌海鲜',\n        label: '忌海鲜'\n      }, {\n        value: '忌油腻',\n        label: '忌油腻'\n      }],\n      rules: {\n        physical_conclusion: [{\n          required: true,\n          message: '请输入体检结论',\n          trigger: 'blur'\n        }],\n        admission_agreement: [{\n          required: true,\n          message: '请选择入院意见',\n          trigger: 'change'\n        }]\n      }\n    };\n  },\n  created() {\n    this.fetchAssessmentDetail();\n  },\n  methods: {\n    async fetchAssessmentDetail() {\n      try {\n        // 获取患者基本信息\n        const patientResponse = await this.$http.get(`/api/patient-info/${this.id}`);\n        if (patientResponse.data.code === 200) {\n          this.patientInfo = patientResponse.data.data;\n        }\n\n        // 获取评估详情\n        const response = await this.$http.get('/api/health-assessment/detail', {\n          params: {\n            assessment_id: this.id\n          }\n        });\n        if (response.data.code === 200) {\n          const data = response.data.data;\n          // 如果有评估数据，说明是查看模式\n          if (data) {\n            this.viewMode = true;\n            this.assessmentForm = {\n              current_illness: data.current_illness,\n              forbidden_medicines: data.forbidden_medicines,\n              diet_restrictions: data.diet_restrictions,\n              physical_conclusion: data.physical_conclusion,\n              admission_agreement: data.admission_agreement\n            };\n          }\n        }\n      } catch (error) {\n        this.$message.error('获取评估信息失败');\n        console.error('Error:', error);\n      }\n    },\n    async submitForm() {\n      try {\n        await this.$refs.assessmentForm.validate();\n        const response = await this.$http.post('/api/health-assessment/submit', {\n          assessment_id: this.id,\n          ...this.assessmentForm\n        });\n        if (response.data.code === 200) {\n          this.$message.success('保存成功');\n          this.$router.push('/assessment');\n        } else {\n          this.$message.error(response.data.message || '保存失败');\n        }\n      } catch (error) {\n        this.$message.error('表单验证失败');\n        console.error('Error:', error);\n      }\n    },\n    resetForm() {\n      this.$refs.assessmentForm.resetFields();\n    }\n  }\n};","map":{"version":3,"names":["name","props","id","type","String","required","data","viewMode","patientInfo","gender","age","admission_number","bed_number","care_grade","registration_date","assessmentForm","current_illness","forbidden_medicines","diet_restrictions","physical_conclusion","admission_agreement","illnessList","value","label","dietRestrictionList","rules","message","trigger","created","fetchAssessmentDetail","methods","patientResponse","$http","get","code","response","params","assessment_id","error","$message","console","submitForm","$refs","validate","post","success","$router","push","resetForm","resetFields"],"sources":["src/views/HealthAssessment.vue"],"sourcesContent":["<template>\n  <div class=\"health-assessment\">\n    <!-- 患者信息卡片 -->\n    <el-card class=\"patient-info-card\">\n      <div slot=\"header\">\n        <span class=\"card-title\">患者信息</span>\n      </div>\n      <el-row :gutter=\"20\">\n        <el-col :span=\"6\">\n          <div class=\"info-item\">\n            <span class=\"label\">姓名：</span>\n            <span class=\"value\">{{ patientInfo.name }}</span>\n          </div>\n        </el-col>\n        <el-col :span=\"6\">\n          <div class=\"info-item\">\n            <span class=\"label\">性别：</span>\n            <span class=\"value\">{{ patientInfo.gender }}</span>\n          </div>\n        </el-col>\n        <el-col :span=\"6\">\n          <div class=\"info-item\">\n            <span class=\"label\">年龄：</span>\n            <span class=\"value\">{{ patientInfo.age }}岁</span>\n          </div>\n        </el-col>\n        <el-col :span=\"6\">\n          <div class=\"info-item\">\n            <span class=\"label\">入院编号：</span>\n            <span class=\"value\">{{ patientInfo.admission_number }}</span>\n          </div>\n        </el-col>\n      </el-row>\n      <el-row :gutter=\"20\" style=\"margin-top: 20px;\">\n        <el-col :span=\"6\">\n          <div class=\"info-item\">\n            <span class=\"label\">床位号：</span>\n            <span class=\"value\">{{ patientInfo.bed_number }}</span>\n          </div>\n        </el-col>\n        <el-col :span=\"6\">\n          <div class=\"info-item\">\n            <span class=\"label\">护理等级：</span>\n            <span class=\"value\">{{ patientInfo.care_grade }}</span>\n          </div>\n        </el-col>\n        <el-col :span=\"12\">\n          <div class=\"info-item\">\n            <span class=\"label\">登记时间：</span>\n            <span class=\"value\">{{ patientInfo.registration_date }}</span>\n          </div>\n        </el-col>\n      </el-row>\n    </el-card>\n\n    <!-- 健康评估表单 -->\n    <el-card class=\"assessment-form-card\">\n      <div slot=\"header\">\n        <span class=\"card-title\">健康评估</span>\n      </div>\n      <el-form \n        ref=\"assessmentForm\" \n        :model=\"assessmentForm\" \n        :rules=\"rules\"\n        label-width=\"120px\"\n        :disabled=\"viewMode\">\n        \n        <el-form-item label=\"现病史\" prop=\"current_illness\">\n          <el-select\n            v-model=\"assessmentForm.current_illness\"\n            multiple\n            filterable\n            allow-create\n            default-first-option\n            placeholder=\"请选择或输入现病史\">\n            <el-option\n              v-for=\"item in illnessList\"\n              :key=\"item.value\"\n              :label=\"item.label\"\n              :value=\"item.value\">\n            </el-option>\n          </el-select>\n        </el-form-item>\n\n        <el-form-item label=\"禁忌药品\" prop=\"forbidden_medicines\">\n          <el-input\n            type=\"textarea\"\n            v-model=\"assessmentForm.forbidden_medicines\"\n            :rows=\"3\"\n            placeholder=\"请输入禁忌药品\">\n          </el-input>\n        </el-form-item>\n\n        <el-form-item label=\"饮食禁忌\" prop=\"diet_restrictions\">\n          <el-select\n            v-model=\"assessmentForm.diet_restrictions\"\n            multiple\n            placeholder=\"请选择饮食禁忌\">\n            <el-option\n              v-for=\"item in dietRestrictionList\"\n              :key=\"item.value\"\n              :label=\"item.label\"\n              :value=\"item.value\">\n            </el-option>\n          </el-select>\n        </el-form-item>\n\n        <el-form-item label=\"体检结论\" prop=\"physical_conclusion\">\n          <el-input\n            type=\"textarea\"\n            v-model=\"assessmentForm.physical_conclusion\"\n            :rows=\"4\"\n            placeholder=\"请输入体检结论\">\n          </el-input>\n        </el-form-item>\n\n        <el-form-item label=\"入院意见\" prop=\"admission_agreement\">\n          <el-radio-group v-model=\"assessmentForm.admission_agreement\">\n            <el-radio label=\"同意入院\">同意入院</el-radio>\n            <el-radio label=\"不同意入院\">不同意入院</el-radio>\n          </el-radio-group>\n        </el-form-item>\n\n        <el-form-item v-if=\"!viewMode\">\n          <el-button type=\"primary\" @click=\"submitForm\">保存评估</el-button>\n          <el-button @click=\"resetForm\">重置</el-button>\n        </el-form-item>\n      </el-form>\n    </el-card>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'HealthAssessment',\n  props: {\n    id: {\n      type: String,\n      required: true\n    }\n  },\n  data() {\n    return {\n      viewMode: false,\n      patientInfo: {\n        name: '',\n        gender: '',\n        age: '',\n        admission_number: '',\n        bed_number: '',\n        care_grade: '',\n        registration_date: ''\n      },\n      assessmentForm: {\n        current_illness: [],\n        forbidden_medicines: '',\n        diet_restrictions: [],\n        physical_conclusion: '',\n        admission_agreement: '同意入院'\n      },\n      illnessList: [\n        { value: '头疼痛', label: '头疼痛' },\n        { value: '发热', label: '发热' },\n        { value: '咳嗽', label: '咳嗽' }\n      ],\n      dietRestrictionList: [\n        { value: '忌辣', label: '忌辣' },\n        { value: '忌海鲜', label: '忌海鲜' },\n        { value: '忌油腻', label: '忌油腻' }\n      ],\n      rules: {\n        physical_conclusion: [\n          { required: true, message: '请输入体检结论', trigger: 'blur' }\n        ],\n        admission_agreement: [\n          { required: true, message: '请选择入院意见', trigger: 'change' }\n        ]\n      }\n    }\n  },\n  created() {\n    this.fetchAssessmentDetail()\n  },\n  methods: {\n    async fetchAssessmentDetail() {\n      try {\n        // 获取患者基本信息\n        const patientResponse = await this.$http.get(`/api/patient-info/${this.id}`)\n        if (patientResponse.data.code === 200) {\n          this.patientInfo = patientResponse.data.data\n        }\n\n        // 获取评估详情\n        const response = await this.$http.get('/api/health-assessment/detail', {\n          params: { assessment_id: this.id }\n        })\n        \n        if (response.data.code === 200) {\n          const data = response.data.data\n          // 如果有评估数据，说明是查看模式\n          if (data) {\n            this.viewMode = true\n            this.assessmentForm = {\n              current_illness: data.current_illness,\n              forbidden_medicines: data.forbidden_medicines,\n              diet_restrictions: data.diet_restrictions,\n              physical_conclusion: data.physical_conclusion,\n              admission_agreement: data.admission_agreement\n            }\n          }\n        }\n      } catch (error) {\n        this.$message.error('获取评估信息失败')\n        console.error('Error:', error)\n      }\n    },\n    async submitForm() {\n      try {\n        await this.$refs.assessmentForm.validate()\n        \n        const response = await this.$http.post('/api/health-assessment/submit', {\n          assessment_id: this.id,\n          ...this.assessmentForm\n        })\n\n        if (response.data.code === 200) {\n          this.$message.success('保存成功')\n          this.$router.push('/assessment')\n        } else {\n          this.$message.error(response.data.message || '保存失败')\n        }\n      } catch (error) {\n        this.$message.error('表单验证失败')\n        console.error('Error:', error)\n      }\n    },\n    resetForm() {\n      this.$refs.assessmentForm.resetFields()\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.health-assessment {\n  padding: 20px;\n\n  .patient-info-card {\n    margin-bottom: 20px;\n  }\n\n  .assessment-form-card {\n    margin-bottom: 20px;\n  }\n\n  .card-title {\n    font-size: 16px;\n    font-weight: 500;\n  }\n\n  .info-item {\n    display: flex;\n    align-items: center;\n    line-height: 32px;\n\n    .label {\n      color: #606266;\n      margin-right: 10px;\n    }\n\n    .value {\n      color: #303133;\n      font-weight: 500;\n    }\n  }\n\n  .el-form {\n    max-width: 800px;\n    margin: 0 auto;\n  }\n}\n</style> "],"mappings":";AAqIA;EACAA,IAAA;EACAC,KAAA;IACAC,EAAA;MACAC,IAAA,EAAAC,MAAA;MACAC,QAAA;IACA;EACA;EACAC,KAAA;IACA;MACAC,QAAA;MACAC,WAAA;QACAR,IAAA;QACAS,MAAA;QACAC,GAAA;QACAC,gBAAA;QACAC,UAAA;QACAC,UAAA;QACAC,iBAAA;MACA;MACAC,cAAA;QACAC,eAAA;QACAC,mBAAA;QACAC,iBAAA;QACAC,mBAAA;QACAC,mBAAA;MACA;MACAC,WAAA,GACA;QAAAC,KAAA;QAAAC,KAAA;MAAA,GACA;QAAAD,KAAA;QAAAC,KAAA;MAAA,GACA;QAAAD,KAAA;QAAAC,KAAA;MAAA,EACA;MACAC,mBAAA,GACA;QAAAF,KAAA;QAAAC,KAAA;MAAA,GACA;QAAAD,KAAA;QAAAC,KAAA;MAAA,GACA;QAAAD,KAAA;QAAAC,KAAA;MAAA,EACA;MACAE,KAAA;QACAN,mBAAA,GACA;UAAAd,QAAA;UAAAqB,OAAA;UAAAC,OAAA;QAAA,EACA;QACAP,mBAAA,GACA;UAAAf,QAAA;UAAAqB,OAAA;UAAAC,OAAA;QAAA;MAEA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,qBAAA;EACA;EACAC,OAAA;IACA,MAAAD,sBAAA;MACA;QACA;QACA,MAAAE,eAAA,cAAAC,KAAA,CAAAC,GAAA,2BAAA/B,EAAA;QACA,IAAA6B,eAAA,CAAAzB,IAAA,CAAA4B,IAAA;UACA,KAAA1B,WAAA,GAAAuB,eAAA,CAAAzB,IAAA,CAAAA,IAAA;QACA;;QAEA;QACA,MAAA6B,QAAA,cAAAH,KAAA,CAAAC,GAAA;UACAG,MAAA;YAAAC,aAAA,OAAAnC;UAAA;QACA;QAEA,IAAAiC,QAAA,CAAA7B,IAAA,CAAA4B,IAAA;UACA,MAAA5B,IAAA,GAAA6B,QAAA,CAAA7B,IAAA,CAAAA,IAAA;UACA;UACA,IAAAA,IAAA;YACA,KAAAC,QAAA;YACA,KAAAQ,cAAA;cACAC,eAAA,EAAAV,IAAA,CAAAU,eAAA;cACAC,mBAAA,EAAAX,IAAA,CAAAW,mBAAA;cACAC,iBAAA,EAAAZ,IAAA,CAAAY,iBAAA;cACAC,mBAAA,EAAAb,IAAA,CAAAa,mBAAA;cACAC,mBAAA,EAAAd,IAAA,CAAAc;YACA;UACA;QACA;MACA,SAAAkB,KAAA;QACA,KAAAC,QAAA,CAAAD,KAAA;QACAE,OAAA,CAAAF,KAAA,WAAAA,KAAA;MACA;IACA;IACA,MAAAG,WAAA;MACA;QACA,WAAAC,KAAA,CAAA3B,cAAA,CAAA4B,QAAA;QAEA,MAAAR,QAAA,cAAAH,KAAA,CAAAY,IAAA;UACAP,aAAA,OAAAnC,EAAA;UACA,QAAAa;QACA;QAEA,IAAAoB,QAAA,CAAA7B,IAAA,CAAA4B,IAAA;UACA,KAAAK,QAAA,CAAAM,OAAA;UACA,KAAAC,OAAA,CAAAC,IAAA;QACA;UACA,KAAAR,QAAA,CAAAD,KAAA,CAAAH,QAAA,CAAA7B,IAAA,CAAAoB,OAAA;QACA;MACA,SAAAY,KAAA;QACA,KAAAC,QAAA,CAAAD,KAAA;QACAE,OAAA,CAAAF,KAAA,WAAAA,KAAA;MACA;IACA;IACAU,UAAA;MACA,KAAAN,KAAA,CAAA3B,cAAA,CAAAkC,WAAA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}